<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Studio EDU - Deep Ocean Edition</title>
    <style>
        :root {
            --primary: #6c5ce7;
            --ocean-bg: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            --panel-bg: rgba(255, 255, 255, 0.95);
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0; min-height: 100vh;
            display: flex; justify-content: center; align-items: center;
            background: var(--ocean-bg);
            color: #2d3436;
        }

        .container {
            display: grid; grid-template-columns: 350px 450px; gap: 20px;
            max-width: 900px; width: 95%; position: relative;
        }

        .panel {
            background: var(--panel-bg); padding: 25px; border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        .header { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .logo { width: 50px; height: 50px; border-radius: 50%; border: 2px solid var(--primary); object-fit: contain; }

        label { display: block; font-size: 0.7rem; font-weight: bold; color: #666; margin: 10px 0 5px; text-transform: uppercase; }
        select, input, textarea { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc; box-sizing: border-box; }

        .btn {
            width: 100%; padding: 14px; border: none; border-radius: 10px;
            background: var(--primary); color: white; cursor: pointer;
            font-weight: bold; display: flex; align-items: center; justify-content: center;
            gap: 8px; margin-top: 10px; transition: 0.2s;
        }
        .btn:hover { filter: brightness(1.1); }

        .cover { 
            width: 100%; height: 240px; border-radius: 12px; background: #dfe6e9 center/cover no-repeat;
            border: 3px solid #fff; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 15px;
        }

        .controls { display: flex; justify-content: center; gap: 10px; margin: 15px 0; }
        .c-btn { width: 50px; height: 50px; border-radius: 12px; border: none; background: var(--primary); color: white; cursor: pointer; }
        .c-btn:disabled { background: #b2bec3; cursor: not-allowed; }

        #timer-box { font-size: 1.4rem; font-weight: bold; color: #d63031; text-align: center; margin-bottom: 10px; }
        #lock-screen {
            position: absolute; inset: 0; background: rgba(0,0,0,0.9);
            border-radius: 20px; display: none; flex-direction: column;
            justify-content: center; align-items: center; color: white; z-index: 100;
        }
    </style>
</head>
<body>

<div class="container">
    <div id="lock-screen"><h1>Time is up</h1><button class="btn" onclick="location.reload()" style="width:150px">Restart</button></div>

    <div class="panel">
        <div class="header">
            <img src="7929d202-ccf0-4e08-8785-785e9179ebd0_removalai_preview.png" class="logo" alt="Logo">
            <h3 style="margin:0">Audio EDU</h3>
        </div>

        <label>–Ø–∑—ã–∫</label>
        <select id="lang">
            <option value="de">Deutsch</option>
            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
            <option value="zh">‰∏≠Êñá</option>
            <option value="en">English</option>
        </select>

        <label>–†–µ–∂–∏–º</label>
        <select id="mode">
            <option value="master">Master Mode (Teacher)</option>
            <option value="study">Study Mode (Student)</option>
            <option value="test">Test Mode (Exam)</option>
        </select>

        <div id="mode-tools" style="margin-top:15px">
            <button class="btn" id="slowBtn" style="background:#00b894; display:none">üê¢ Slow Motion (0.8x)</button>
            <button class="btn" id="loopBtn" style="background:#0984e3; display:none">üîÑ Loop: Off</button>
        </div>

        <label style="margin-top:20px">Iframe Code</label>
        <textarea id="iframe-out" readonly style="height:50px; font-size:0.7rem"></textarea>
        <button class="btn" id="copyBtn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
    </div>

    <div class="panel">
        <div id="mode-info" style="font-size: 0.7rem; font-weight: bold; color: var(--primary); margin-bottom: 5px;">MASTER MODE</div>
        <div class="cover" id="coverArt"></div>
        
        <div id="timer-box" style="display:none">02:00</div>
        
        <input type="range" id="progress" value="0" step="0.1" style="width:100%">
        <div style="text-align:center; font-size:0.8rem; margin: 5px 0">
            <span id="curTime">00:00</span> / <span id="durTime">00:00</span>
        </div>

        <div class="controls">
            <button class="c-btn" id="rew">‚è™</button>
            <button class="c-btn" id="play" style="width:60px; height:60px; border-radius:50%">‚ñ∂</button>
            <button class="c-btn" id="fwd">‚è©</button>
        </div>

        <label>–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞—É–¥–∏–æ</label>
        <input type="file" id="audioInput" accept="audio/*">
    </div>
</div>

<script>
    const audio = new Audio();
    let playCount = 0;
    let testTimer;

    const modeSelect = document.getElementById('mode');
    const playBtn = document.getElementById('play');
    const prog = document.getElementById('progress');

    // –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤
    modeSelect.onchange = () => {
        const mode = modeSelect.value;
        document.getElementById('mode-info').innerText = mode.toUpperCase() + " MODE";
        document.getElementById('slowBtn').style.display = (mode === 'study') ? 'flex' : 'none';
        document.getElementById('loopBtn').style.display = (mode === 'master') ? 'flex' : 'none';
        document.getElementById('timer-box').style.display = (mode === 'test') ? 'block' : 'none';
        
        // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
        playCount = 0;
        audio.playbackRate = 1;
        audio.loop = false;
        clearInterval(testTimer);
        prog.disabled = false;
        document.getElementById('rew').disabled = false;
        document.getElementById('fwd').disabled = false;
        document.getElementById('timer-box').innerText = "02:00";
    };

    // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
    playBtn.onclick = () => {
        if (!audio.src) return;
        
        if (audio.paused) {
            const mode = modeSelect.value;
            playCount++;

            if (mode === 'test') {
                prog.disabled = true;
                document.getElementById('rew').disabled = true;
                document.getElementById('fwd').disabled = true;
                startTest();
            }

            if (mode === 'study' && playCount >= 3) {
                prog.disabled = true;
                document.getElementById('rew').disabled = true;
                document.getElementById('fwd').disabled = true;
            }

            audio.play();
            playBtn.innerText = '‚è∏';
        } else {
            audio.pause();
            playBtn.innerText = '‚ñ∂';
        }
    };

    function startTest() {
        let time = 120;
        testTimer = setInterval(() => {
            time--;
            let m = Math.floor(time/60), s = time%60;
            document.getElementById('timer-box').innerText = `${m}:${s < 10 ? '0'+s : s}`;
            if (time <= 0) {
                audio.pause();
                document.getElementById('lock-screen').style.display = 'flex';
                clearInterval(testTimer);
            }
        }, 1000);
    }

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    document.getElementById('slowBtn').onclick = () => {
        audio.playbackRate = (audio.playbackRate === 1) ? 0.8 : 1;
        document.getElementById('slowBtn').innerText = (audio.playbackRate === 0.8) ? "‚ñ∂ Normal Speed" : "üê¢ Slow Motion (0.8x)";
    };

    document.getElementById('loopBtn').onclick = () => {
        audio.loop = !audio.loop;
        document.getElementById('loopBtn').innerText = audio.loop ? "üîÑ Loop: ON" : "üîÑ Loop: OFF";
    };

    document.getElementById('audioInput').onchange = (e) => {
        const file = e.target.files[0];
        if (file) audio.src = URL.createObjectURL(file);
    };

    audio.ontimeupdate = () => {
        prog.max = audio.duration || 0;
        prog.value = audio.currentTime;
        const fmt = s => new Date(s * 1000).toISOString().substr(14, 5);
        document.getElementById('curTime').innerText = fmt(audio.currentTime);
        document.getElementById('durTime').innerText = fmt(audio.duration || 0);
    };

    prog.oninput = (e) => audio.currentTime = e.target.value;
    document.getElementById('rew').onclick = () => audio.currentTime -= 10;
    document.getElementById('fwd').onclick = () => audio.currentTime += 10;

    document.getElementById('copyBtn').onclick = () => {
        const code = `<iframe src="${window.location.href}" width="100%" height="700px" frameborder="0"></iframe>`;
        document.getElementById('iframe-out').value = code;
        navigator.clipboard.writeText(code);
        alert("–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!");
    };
</script>
</body>
</html>
