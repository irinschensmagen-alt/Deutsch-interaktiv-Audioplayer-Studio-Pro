<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Audio Studio v8.1 - Fixed View</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --p: #38bdf8; --bg: #0f172a; }
        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Inter', sans-serif; background: #020617; color: #fff; overflow: hidden; }
        .app { display: flex; height: 100vh; width: 100vw; }
        /* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .side { width: 380px; min-width: 380px; background: var(--bg); padding: 25px; border-right: 1px solid #1e293b; display: flex; flex-direction: column; gap: 15px; overflow-y: auto; box-sizing: border-box; z-index: 100; }
        h2 { color: var(--p); font-size: 20px; margin: 0; font-weight: 700; text-transform: uppercase; }
        .f { display: flex; flex-direction: column; gap: 5px; }
        label { font-size: 10px; color: #94a3b8; text-transform: uppercase; font-weight: 800; }
        input { background: #1e293b; border: 1px solid #334155; border-radius: 8px; padding: 10px; color: #fff; outline: none; }
        .btn { background: linear-gradient(135deg, #38bdf8, #818cf8); color: white; border: none; padding: 15px; border-radius: 12px; font-weight: 700; cursor: pointer; margin-top: auto; }
        /* –ü—Ä–∞–≤–∞—è –∑–æ–Ω–∞ (–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª) */
        .main { flex-grow: 1; position: relative; display: flex; align-items: center; justify-content: center; background: #020617; background-image: radial-gradient(#1e293b 1px, transparent 1px); background-size: 20px 20px; overflow: auto; }
        #preview-container { display: flex; align-items: center; justify-content: center; min-width: 100%; min-height: 100%; }
        iframe { border: none; background: #000; border-radius: 30px; box-shadow: 0 0 50px rgba(0,0,0,0.5); }
        .rainbow-text { animation: rainbow 5s linear infinite; font-weight: 800; font-size: 11px; margin-bottom: 10px; }
        @keyframes rainbow { 0% { color: #ff0000; } 25% { color: #00ff00; } 50% { color: #0000ff; } 75% { color: #ffff00; } 100% { color: #ff0000; } }
    </style>
</head>
<body>
<div class="app">
    <aside class="side">
        <h2>Audio Studio v8.1</h2>
        <div class="rainbow-text">ANIMATED COLOR MODE ACTIVE</div>
        <div class="f"><label>–¶–≤–µ—Ç –∞–∫—Ü–µ–Ω—Ç–∞:</label><input type="color" id="c" value="#38bdf8"></div>
        <div class="f"><label>GitHub URL (–ü–∞–ø–∫–∞ audio):</label><input type="text" id="u" value="https://github.com/irinschensmagen-alt/audioplayer/tree/main/audio"></div>
        <div class="f"><label>–§–æ–Ω –ø–ª–µ–µ—Ä–∞ (URL):</label><input type="text" id="b" value="https://images.unsplash.com/photo-1483354483454-4cd359948304?w=800"></div>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <div class="f"><label>–®–∏—Ä–∏–Ω–∞:</label><input type="number" id="w" value="350"></div>
            <div class="f"><label>–í—ã—Å–æ—Ç–∞:</label><input type="number" id="h" value="500"></div>
        </div>
        <div class="f"><label>–ì—Ä–æ–º–∫–æ—Å—Ç—å:</label><input type="range" id="v" min="0" max="1" step="0.1" value="0.7" style="accent-color:var(--p)"></div>
        <button class="btn" onclick="copy()">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è Genially</button>
    </aside>
    <main class="main"><div id="preview-container"></div></main>
</div>
<script>
    function draw() {
        const col = document.getElementById('c').value, url = document.getElementById('u').value.trim(), bg = document.getElementById('b').value.trim(), 
              w = document.getElementById('w').value, h = document.getElementById('h').value, vol = document.getElementById('v').value;
        document.documentElement.style.setProperty('--p', col);
        let api, raw;
        try {
            const p = url.replace('https://github.com/', '').split('/');
            api = `https://api.github.com/repos/${p[0]}/${p[1]}/contents/${p.slice(4).join('/')}?ref=${p[3]||'main'}`;
            raw = `https://raw.githubusercontent.com/${p[0]}/${p[1]}/${p[3]||'main'}/${p.slice(4).join('/')}`;
        } catch(e) {}
        const player = `
<div style="width:100%; height:100%; position:relative; background:url('${bg}') center/cover no-repeat; font-family:sans-serif; overflow:hidden;">
    <div style="position:absolute; inset:0; background:rgba(0,0,0,0.3); backdrop-filter:blur(10px); -webkit-backdrop-filter:blur(10px);"></div>
    <div style="position:relative; z-index:2; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:20px; box-sizing:border-box; color:white;">
        <img src="${raw}/cover.jpg" style="width:120px; height:120px; border-radius:20px; object-fit:cover; border:2px solid white; margin-bottom:15px;" onerror="this.src='https://via.placeholder.com/120?text=Music'">
        <div id="t" style="font-weight:700; font-size:18px; text-align:center; height:45px; overflow:hidden;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <div style="display:flex; align-items:center; gap:20px; margin:20px 0;">
            <button onclick="pPr()" style="background:none; border:none; color:white; font-size:24px; cursor:pointer;">‚èÆ</button>
            <button onclick="pPl()" id="pb" style="width:60px; height:60px; background:white; color:black; border-radius:50%; border:none; font-size:24px; cursor:pointer;">‚ñ∂</button>
            <button onclick="pNe()" style="background:none; border:none; color:white; font-size:24px; cursor:pointer;">‚è≠</button>
        </div>
        <input type="range" id="pr" value="0" style="width:100%; accent-color:${col}; margin-bottom:15px; animation: rb 5s linear infinite;">
        <div style="display:flex; align-items:center; gap:10px; width:100%;"><span style="font-size:12px;">üîà</span><input type="range" id="vl" min="0" max="1" step="0.1" value="${vol}" style="flex-grow:1; accent-color:${col};"></div>
        <button onclick="tL()" style="margin-top:20px; background:rgba(255,255,255,0.2); border:1px solid rgba(255,255,255,0.3); color:white; padding:8px 15px; border-radius:20px; font-size:12px; cursor:pointer;">–ü–õ–ï–ô–õ–ò–°–¢</button>
    </div>
    <div id="ls" style="position:absolute; inset:0; background:rgba(0,0,0,0.9); z-index:5; display:none; padding:30px; overflow-y:auto; color:white;">
        <div style="display:flex; justify-content:space-between; margin-bottom:20px;"><b>–ü–ª–µ–π–ª–∏—Å—Ç</b><button onclick="tL()" style="background:none; border:none; color:${col}; cursor:pointer;">–ó–ê–ö–†–´–¢–¨</button></div>
        <div id="it"></div>
    </div>
    <audio id="au" crossorigin="anonymous"></audio>
</div>
<style> @keyframes rb { 0%{accent-color:#ff0000} 25%{accent-color:#00ff00} 50%{accent-color:#0000ff} 75%{accent-color:#ffff00} 100%{accent-color:#ff0000} } </style>
<script>
(function(){
    const a=document.getElementById('au'), t=document.getElementById('t'), b=document.getElementById('pb'), p=document.getElementById('pr'), v=document.getElementById('vl'), s=document.getElementById('ls'), i=document.getElementById('it');
    let trk=[], cur=0;
    fetch('${api}').then(r=>r.json()).then(d=>{
        trk=d.filter(f=>f.name.toLowerCase().endsWith('.mp3')).map(f=>({n:f.name.replace('.mp3',''), u:f.download_url}));
        if(trk.length){ trk.forEach((x,j)=>{ let d=document.createElement('div'); d.innerText=(j+1)+'. '+x.n; d.style.padding='10px'; d.onclick=()=>{load(j);tL();}; i.appendChild(d); }); load(0, false); }
    });
    function load(j,m=true){ cur=j; a.src=trk[j].u; t.innerText=trk[j].n; if(m) a.play().then(()=>b.innerText='‚è∏'); }
    window.pPl=()=>{ if(a.paused){ a.play(); b.innerText='‚è∏'; } else { a.pause(); b.innerText='‚ñ∂'; } };
    window.pNe=()=>{ cur=(cur+1)%trk.length; load(cur); };
    window.pPr=()=>{ cur=(cur-1+trk.length)%trk.length; load(cur); };
    window.tL=()=>{ s.style.display=s.style.display==='none'?'block':'none'; };
    a.ontimeupdate=()=>p.value=(a.currentTime/a.duration)*100||0;
    p.oninput=()=>a.currentTime=(p.value/100)*a.duration;
    v.oninput=()=>a.volume=v.value;
    a.volume=${vol};
})();
<\/script>`;
        const final = `<iframe srcdoc='${player.replace(/'/g, "&apos;").replace(/<\/script>/g, '<\\/script>')}' width="${w}" height="${h}"></iframe>`;
        document.getElementById('preview-container').innerHTML = final;
        window.res = final;
    }
    document.querySelectorAll('input').forEach(i => i.oninput = draw);
    window.onload = draw;
    function copy() { navigator.clipboard.writeText(window.res); alert("–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!"); }
</script>
</body>
</html>
