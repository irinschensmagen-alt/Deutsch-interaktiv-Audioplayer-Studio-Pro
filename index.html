<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Studio EDU PRO - Final Edition</title>
    <style>
        :root {
            --primary: #6c5ce7;
            --glass: rgba(255, 255, 255, 0.88);
        }

        /* –¢–µ–º—ã —Ñ–æ–Ω–∞ */
        body.chameleon {
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientMove 15s ease infinite;
        }
        body.pastel {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        @keyframes gradientMove { 0% {background-position:0% 50%} 50% {background-position:100% 50%} 100% {background-position:0% 50%} }

        body { font-family: 'Segoe UI', sans-serif; margin: 0; min-height: 100vh; display: flex; justify-content: center; align-items: center; transition: 0.5s; }

        .container { display: grid; grid-template-columns: 380px 520px; gap: 20px; max-width: 1000px; width: 95%; position: relative; }

        .panel { background: var(--glass); backdrop-filter: blur(15px); padding: 25px; border-radius: 30px; border: 1px solid rgba(255,255,255,0.4); box-shadow: 0 20px 40px rgba(0,0,0,0.15); }

        .header { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; border-bottom: 2px solid var(--primary); padding-bottom: 10px; }
        /* –õ–æ–≥–æ—Ç–∏–ø –ø–æ –≤–∞—à–µ–º—É –Ω–∞–∑–≤–∞–Ω–∏—é —Å GitHub */
        .logo { width: 55px; height: 55px; border-radius: 50%; border: 2px solid var(--primary); background: #fff; object-fit: contain; }

        label { display: block; font-size: 0.7rem; font-weight: 700; color: #555; margin: 12px 0 5px; text-transform: uppercase; }
        select, input, textarea { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid rgba(0,0,0,0.1); font-size: 0.9rem; }

        .btn { width: 100%; padding: 14px; border: none; border-radius: 12px; background: var(--primary); color: white; cursor: pointer; font-weight: bold; display: flex; align-items: center; justify-content: center; gap: 8px; margin-top: 10px; transition: 0.3s; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(108, 92, 231, 0.3); }

        .cover-box { width: 100%; height: 260px; border-radius: 20px; background: #eee center/cover no-repeat; border: 5px solid #fff; box-shadow: 0 10px 20px rgba(0,0,0,0.1); margin-bottom: 15px; position: relative; }

        .controls { display: flex; justify-content: center; gap: 15px; margin: 15px 0; }
        .c-btn { width: 55px; height: 55px; border-radius: 15px; border: none; background: var(--primary); color: white; font-size: 1.3rem; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .c-btn:disabled { background: #b2bec3; cursor: not-allowed; }

        #timer { font-size: 1.8rem; font-weight: bold; color: #ff4757; text-align: center; margin-bottom: 10px; display: none; font-family: monospace; }
        
        #lock-screen { position: absolute; inset: 0; background: rgba(0,0,0,0.9); border-radius: 30px; display: none; flex-direction: column; justify-content: center; align-items: center; color: white; z-index: 1000; }

        .status-tag { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 0.7rem; font-weight: bold; color: white; background: var(--primary); margin-bottom: 10px; }
    </style>
</head>
<body class="chameleon"> <div class="container">
    <div id="lock-screen"><h1>Time is up</h1><button class="btn" onclick="location.reload()" style="width:150px">Restart</button></div>

    <div class="panel">
        <div class="header">
            <img src="7929d202-ccf0-4e08-8785-785e9179ebd0_removalai_preview.png" class="logo" alt="Logo" onerror="this.src='https://via.placeholder.com/55?text=EDU'">
            <h3 style="margin:0">Audio EDU Pro</h3>
        </div>

        <label>üé® –§–æ–Ω —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞</label>
        <select id="bgTheme">
            <option value="chameleon">–ì—Ä–∞–¥–∏–µ–Ω—Ç "–•–∞–º–µ–ª–µ–æ–Ω"</option>
            <option value="pastel">–ü–∞—Å—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–Ω–∞</option>
        </select>

        <label>üåê –Ø–∑—ã–∫ (–ê–≤—Ç–æ-–æ–±–ª–æ–∂–∫–∞)</label>
        <select id="langSelect">
            <option value="de" data-img="germany,berlin">Deutsch</option>
            <option value="ru" data-img="russia,nature">–†—É—Å—Å–∫–∏–π</option>
            <option value="zh" data-img="china,culture">‰∏≠Êñá (–ö–∏—Ç–∞–π—Å–∫–∏–π)</option>
            <option value="en" data-img="london,bigben">English</option>
            <option value="fr" data-img="paris,france">Fran√ßais</option>
        </select>

        <label>üéì –†–µ–∂–∏–º</label>
        <select id="modeSelect">
            <option value="master">Master Mode (Teacher)</option>
            <option value="study">Study Mode (Student)</option>
            <option value="test">Test Mode (Exam)</option>
        </select>

        <div style="margin-top:15px">
            <button class="btn" id="slowBtn" style="background:#00b894; display:none">üê¢ Slow Motion (0.8x)</button>
            <button class="btn" id="loopBtn" style="background:#0984e3; display:none">üîÑ Loop: OFF</button>
        </div>

        <label style="margin-top:20px">üì¶ –ö–æ–¥ –¥–ª—è Genially</label>
        <textarea id="iframeOutput" readonly style="height:50px"></textarea>
        <button class="btn" id="copyBtn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
    </div>

    <div class="panel">
        <div class="status-tag" id="modeTag">MASTER MODE</div>
        <div class="cover-box" id="coverArt"></div>
        
        <div id="timer">02:00</div>
        
        <input type="range" id="progressBar" value="0" step="0.1" style="width:100%; accent-color: var(--primary);">
        <div id="timeInfo" style="text-align:center; font-size:0.8rem; margin:5px 0; font-family:monospace; font-weight:bold;">00:00 / 00:00</div>

        <div class="controls">
            <button class="c-btn" id="rewBtn">‚è™</button>
            <button class="c-btn" id="playBtn" style="width:75px; height:75px; border-radius:50%">‚ñ∂</button>
            <button class="c-btn" id="fwdBtn">‚è©</button>
        </div>

        <div style="border-top:1px solid #ddd; padding-top:10px">
            <label>üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ—ë –∞—É–¥–∏–æ</label>
            <input type="file" id="audioInput" accept="audio/*">
            
            <label>üñºÔ∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ—é –æ–±–ª–æ–∂–∫—É</label>
            <input type="file" id="coverInput" accept="image/*">
        </div>
    </div>
</div>

<script>
    const audio = new Audio();
    let playCount = 0;
    let timerInt;

    // 1. –°–º–µ–Ω–∞ —Ñ–æ–Ω–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
    document.getElementById('bgTheme').onchange = (e) => {
        document.body.className = e.target.value;
    };

    // 2. –£–º–Ω–∞—è –æ–±–ª–æ–∂–∫–∞ –ø–æ —è–∑—ã–∫—É
    function setLangCover() {
        const keyword = document.getElementById('langSelect').selectedOptions[0].dataset.img;
        document.getElementById('coverArt').style.backgroundImage = `url('https://source.unsplash.com/featured/?${keyword}')`;
    }
    document.getElementById('langSelect').onchange = setLangCover;
    setLangCover();

    // 3. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–æ–µ–π –æ–±–ª–æ–∂–∫–∏
    document.getElementById('coverInput').onchange = (e) => {
        const file = e.target.files[0];
        if (file) {
            document.getElementById('coverArt').style.backgroundImage = `url(${URL.createObjectURL(file)})`;
        }
    };

    // 4. –õ–æ–≥–∏–∫–∞ —Ä–µ–∂–∏–º–æ–≤
    document.getElementById('modeSelect').onchange = () => {
        const mode = document.getElementById('modeSelect').value;
        document.getElementById('modeTag').innerText = mode.toUpperCase() + " MODE";
        document.getElementById('slowBtn').style.display = (mode === 'study') ? 'flex' : 'none';
        document.getElementById('loopBtn').style.display = (mode === 'master') ? 'flex' : 'none';
        document.getElementById('timer').style.display = (mode === 'test') ? 'block' : 'none';
        
        // –°–±—Ä–æ—Å
        playCount = 0;
        audio.playbackRate = 1;
        audio.loop = false;
        clearInterval(timerInt);
        document.getElementById('progressBar').disabled = false;
        document.getElementById('rewBtn').disabled = false;
        document.getElementById('fwdBtn').disabled = false;
        document.getElementById('timer').innerText = "02:00";
    };

    // 5. –†–∞–±–æ—Ç–∞ –ø–ª–µ–µ—Ä–∞
    document.getElementById('playBtn').onclick = () => {
        if (!audio.src) return alert("–í—ã–±–µ—Ä–∏—Ç–µ –∞—É–¥–∏–æ—Ñ–∞–π–ª!");
        
        if (audio.paused) {
            const mode = document.getElementById('modeSelect').value;
            
            if (mode === 'test') {
                document.getElementById('progressBar').disabled = true;
                document.getElementById('rewBtn').disabled = true;
                document.getElementById('fwdBtn').disabled = true;
                startExam();
            }

            if (mode === 'study') {
                playCount++;
                if (playCount >= 3) {
                    document.getElementById('progressBar').disabled = true;
                    document.getElementById('rewBtn').disabled = true;
                    document.getElementById('fwdBtn').disabled = true;
                }
            }

            audio.play();
            document.getElementById('playBtn').innerText = '‚è∏';
        } else {
            audio.pause();
            document.getElementById('playBtn').innerText = '‚ñ∂';
        }
    };

    function startExam() {
        let time = 120;
        timerInt = setInterval(() => {
            time--;
            let m = Math.floor(time/60), s = time%60;
            document.getElementById('timer').innerText = `${m}:${s < 10 ? '0'+s : s}`;
            if (time <= 0) {
                audio.pause();
                document.getElementById('lock-screen').style.display = 'flex';
                clearInterval(timerInt);
            }
        }, 1000);
    }

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    document.getElementById('slowBtn').onclick = function() {
        audio.playbackRate = (audio.playbackRate === 1) ? 0.8 : 1;
        this.innerText = (audio.playbackRate === 0.8) ? "‚ñ∂ Normal Speed" : "üê¢ Slow Motion (0.8x)";
    };

    document.getElementById('loopBtn').onclick = function() {
        audio.loop = !audio.loop;
        this.innerText = audio.loop ? "üîÑ Loop: ON" : "üîÑ Loop: OFF";
    };

    document.getElementById('audioInput').onchange = (e) => {
        const file = e.target.files[0];
        if (file) audio.src = URL.createObjectURL(file);
    };

    audio.ontimeupdate = () => {
        const prog = document.getElementById('progressBar');
        prog.max = audio.duration || 0;
        prog.value = audio.currentTime;
        const fmt = s => new Date(s * 1000).toISOString().substr(14, 5);
        document.getElementById('timeInfo').innerText = `${fmt(audio.currentTime)} / ${fmt(audio.duration || 0)}`;
    };

    document.getElementById('progressBar').oninput = (e) => audio.currentTime = e.target.value;
    document.getElementById('rewBtn').onclick = () => audio.currentTime -= 10;
    document.getElementById('fwdBtn').onclick = () => audio.currentTime += 10;

    document.getElementById('copyBtn').onclick = () => {
        const code = `<iframe src="${window.location.href}" width="100%" height="750px" frameborder="0"></iframe>`;
        document.getElementById('iframeOutput').value = code;
        navigator.clipboard.writeText(code);
        alert("–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!");
    };
</script>
</body>
</html>
